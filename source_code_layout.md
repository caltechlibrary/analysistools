---
title: Source code layout
---

# Source Code Layout

The source code originated from porting a Python proof of concept to Go. The primary result is a single command line tool (at present) called **phrasecheck**. It can produce CSV output for four different analysis. 

mimetypes
: least files in a directory reporting on filename and possible mime type

filetypes
: walk a directory and list the file extensions found along a count.

check
; check files against a pattern list and report occurrences where the pattern was found

check-directory
: walk a directory and check each file against a pattern list. Only works for UTF-8 text files.

The two reports, mimetypes and filetypes are drive by the directory walk functin in [filetypes.go](filetypes.go). This file also includes a hard coded Mime Type map from extension to mime type. If the extension is not in the list the "application/octet-stream" is returned.

The check and check-directory reports are defined primarily in [phrasecheck.go](tokenizer.go). This file also includes the support for the command line
tool (i.e. "Run()" function). The check function rely on a stream of tokens. Each token has a value, work number and line number. The check function in phrasecheck.go use the token list for comaparison and reporting. 

The [tokenizer.go](tokenizer.go) file contains the tokenizer functions as well as defining the struct of the tokens returned.  The allows you to read a file once, get a single token list and perform multiple analysis on the token list without needing to reread it from disk for each analysis.  The token list will need to fit in memory so for extremely large files this may fail.

The [version.go](version.go) is generated by CMTools. It holds the version, license and release information for the program or other projects that use the analysistools module.

[helptext.go](helptext.go)
: This is the file that holds all the helptext in the application.  That output of the help content is used by the Makefile to generate man pages via Pandoc.


The files ending in "_test.go" are test files used by `go test` command.

## Standard development files

codemeta.json
: This is the primary repository metadata file. It is used by CMTools to generate everything from the version.go to various bits of documentation.

CITATION.cff
: This is generated from the codemeta.json by CMTools


README.md
: This stardard README for the project. This can be generated by CMTools using the codemeta.json but usually is managed by hand after intial creation.

about.md
: This is an about page generate from the codemeta.json file by CMTools

user_manual.md
: This file is a directory of repository documentation. It should have a least the main page linked in. 

Makefile
: GNU Makefile to building the project and installing locally on your development machine. The Makefile is largely generated by CMTools based on the contents of codemeta.json.

website.mak
: This is a Makefile for generating the web documentation.

INSTALL.md, INSTALL_NOTES_macOS.md, INSTALL_NOTES_Windows.md
: This is the CMTools generated install documentation based on codemeta.json

search.md
: This is a PageFind search page used to search the document in this repository on the repository's public website.

publish.bash, publish.ps1
: This publishes the web docs to gh-pages branch and pushes to GitHub. This is generated by CMTools

release.bash, release.ps1
: This uses GitHub `gh` utility to make a release. This is run after `make release` completes. These scripts are generated by CMTools

TODO.md
: This is a hand curated list of action items I use as reference.

installer.sh, installer.ps1
: These are Bash and Powershell scripts used to install phrasecheck and man pages from the project website using curl or the Windows equivallents. They are generated by CMTools. See [INSTALL.md] for details.

links-to-html.lua 
: This is a Lua script used by Pandoc when building the website. It is referenced in the website.mak makefile.

page.tmpl
: This is a Pandoc template for building the web docs. It is used by Pandoc in the website.mak. It is generated by CMTools.






